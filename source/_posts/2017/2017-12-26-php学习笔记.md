---
layout: posts
title: PHP学习笔记
categories: php学习笔记
tags: 
	- php
	- 数据库
---
### 1.定义常量  
```
<?php
	header("Content-type:text/html;charset=utf-8");
	define('HOST', '127.0.0.1');
	define('USERNAME', 'root');
	define('PASSWORD', '1111');
?>
```

### 2.引用其它页面  
```
<?php 
	require_once('config.php');
?>
```

### 3.连接MySQL数据库并设定数据库字符集 
```
<?php 

	require_once('config.php');
    $con=mysqli_connect(HOST,USERNAME,PASSWORD,"mydb"); //mydb为数据库名
    mysqli_set_charset($con,"utf8");

?>
```
<!-- more -->
### 4.获取POST请求的变量
```
<?php
	require_once('../connect.php');//连接数据库
	print_r($_POST);//输出表单提交的数据
	if (!(isset($_POST['title'])&&(!empty($_POST['title'])))) {//判断变量是否设置以及是否为空
		echo "<script>alert('标题不能为空');window.location.href='xxxx.html'</script>";//执行js代码
	}
	$title=$_POST['title'];//获取表单中name对应的value
	date_default_timezone_set('Asia/Shanghai');//设置时区	
	$Date=date('Y-m-d H:i:s');//获取系统时间
?>
<!-- more -->
```


### 5.MySQL插入语句  
```
<?php
	require_once('../connect.php');//连接数据库
	$title=$_POST['title'];
	$insertsql="insert into test(title) values('$title')";//其中test为表名
	echo $insertsql;//打印sql语句，可以复制到客户端执行检查是否正确
	if(mysqli_query($con,$insertsql)){
		echo "<script>alert('插入成功')</script>";
	
	}
	else {	echo "<script>alert('插入失败')";
	}
?>
```

### 6.MySQL查询(实现登录实例)
```
<?php
	require_once('../connect.php');
	$name=$_POST['name'];
	$password=$_POST['password'];
	$sql="select * from user where name='$name'";//从user的表中查询name为'$name'的全部属性
	 $query=mysqli_query($con,$sql);//执行sql语句
	 $pass=mysqli_fetch_assoc($query);//结果转化为关联数组
	 $temp=$pass['password'];
	 if ($temp==$password) {
	 	setcookie("username",$name,time()+3600*3);//设置cookie
	 	echo "<script>
	 	alert('登录成功');window.location.href='xxx.html'
	 	</script>";
	 }
	else echo "<script>alert('用户名或密码错误，请重试');window.location.href='login.html'</script>";
?>
```

### 7.MySQL删除
```
{% highlight php %}
<?php
	require_once('../connect.php');
	$id=$_GET['id'];
	$deletsql="delete from test where id=$id";
	if (mysqli_query($con,$deletsql)) {
		echo "<script>alert('删除成功')</script>";}
	else{echo "<script>alert('删除失败')</script>";}
?>
{% endhighlight %}
```

### 8.设置及获取cookie
```
setcookie("username",$name,time()+3600*3);//设置cookie
<?php echo $_COOKIE["username"]?>;//获取cookie
```

### 注：
#### 1.php是在服务端解析的，所以需要在服务端配置php环境。  
#### 2.html可以嵌套php语句但文件后缀需命名为.php,否则不解析。  
#### 3.php5版本以后连数据库用的是mysqli和PDO,需要在配置文件中打开相应扩展。
